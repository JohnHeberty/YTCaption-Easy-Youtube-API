# ===== CONFIGURAÇÃO DO SERVIÇO DE DUBLAGEM E CLONAGEM DE VOZ =====
# Copie este arquivo para .env e ajuste os valores conforme necessário

# ===== APLICAÇÃO =====
APP_NAME=Audio Voice Service
VERSION=1.0.0
ENVIRONMENT=development  # development, staging, production
DEBUG=false

# ===== SERVIDOR =====
HOST=0.0.0.0
DIVISOR=5
PORT=800${DIVISOR}

# ===== REDIS =====
# Para Docker Compose: redis://redis:6379/0
# Para desenvolvimento local: redis://localhost:6379/0
# Para Redis remoto: redis://usuario:senha@host:porta/db
REDIS_URL=redis://192.168.18.110:6379/${DIVISOR}

# ===== CELERY =====
CELERY_BROKER_URL=${REDIS_URL}  # Usa mesma URL do Redis
CELERY_RESULT_BACKEND=${REDIS_URL}  # Usa mesma URL do Redis
CELERY_TASK_TIME_LIMIT=1800  # 30 minutos máximo por task
CELERY_TASK_SOFT_TIME_LIMIT=1600  # 26.6 minutos soft limit
CELERY_WORKER_PREFETCH_MULTIPLIER=1
CELERY_WORKER_MAX_TASKS_PER_CHILD=50

# ===== CACHE =====
CACHE_TTL_HOURS=24
CACHE_CLEANUP_INTERVAL_MINUTES=30
CACHE_MAX_SIZE_MB=2048
VOICE_PROFILE_TTL_DAYS=30

# ===== LIMITES DE PROCESSAMENTO =====
MAX_FILE_SIZE_MB=100  # Tamanho máximo do arquivo (1-500MB)
MAX_DURATION_MINUTES=60  # Duração máxima do áudio (1-60 minutos)
MAX_TEXT_LENGTH=10000  # Máximo de caracteres para dublagem
MAX_CONCURRENT_JOBS=3
JOB_TIMEOUT_MINUTES=15

# ===== F5-TTS - OTIMIZADO PARA PT-BR NATURAL =====
F5TTS_MODEL=F5-TTS  # F5-TTS (recomendado) ou E2TTS_Base
F5TTS_DEVICE=cuda  # cuda ou cpu (GPU recomendado - 10-30x mais rápido)
F5TTS_CACHE=/app/models/f5tts  # Cache dos modelos F5-TTS
F5TTS_CUSTOM_MODEL_PATH=/app/models/f5tts/pt-br/model_last.safetensors  # MODELO PT-BR CUSTOMIZADO (deixe vazio para HF padrão)
F5TTS_CUSTOM_VOCAB_PATH=  # Vocab customizado (vazio = usa padrão HF)
F5TTS_NFE_STEP=48  # NFE steps: 32=balanceado, 48=REFINADO PT-BR (natural), 64=muito refinado
F5TTS_CFG_STRENGTH=1.5  # Aderência: 1.5=FLEXÍVEL PT-BR (natural), 2.0=balanceado inglês, 3.5=rígido
F5TTS_SWAY_COEF=-3.0  # Prosódia: -3.0=CONVERSACIONAL PT-BR (emotivo), -1.0=moderado, 0.0=neutro
F5TTS_TARGET_RMS=0.3  # Volume: 0.3=VOZ PRESENTE (autoritativa), 0.25=seguro, 0.1=baixo (chiado)
F5TTS_CROSS_FADE=0.15  # Transições: 0.15s=SMOOTH (otimizado), 0.25s=mais longo
F5TTS_USE_FP16=true  # Float16 para economia de VRAM (recomendado)
F5TTS_ODE_METHOD=euler  # ODE solver: euler=RÁPIDO (estável), midpoint=lento

# ===== WHISPER - OTIMIZADO PARA PT-BR NATIVO =====
WHISPER_DEVICE=cuda  # cuda ou cpu (GPU RECOMENDADO para transcrição rápida)
WHISPER_MODEL=medium  # base (74M), small (244M), medium (769M - PT-BR NATIVO), large (1550M)
WHISPER_LANGUAGE=pt  # Idioma forçado: pt (português brasileiro)
WHISPER_INITIAL_PROMPT=Olá, tudo bem? Como você está? Ótimo!  # Hint PT-BR para melhor reconhecimento
WHISPER_TEMPERATURE=0.0  # Temperatura: 0.0=DETERMINÍSTICO (consistente), 0.2=criativo
WHISPER_COMPRESSION_RATIO=2.4  # Detecta repetições/loops (2.4=padrão)
WHISPER_LOGPROB_THRESHOLD=-1.0  # Filtra tokens incertos (-1.0=padrão)
WHISPER_NO_SPEECH_THRESHOLD=0.6  # Detecta silêncio (0.6=padrão)
WHISPER_CONDITION_PREV=false  # Usar contexto anterior: false=EVITA ERRO CASCADE
WHISPER_BATCH_SIZE=8  # Batch size: 8=safe 8GB VRAM, 4=safe 6GB VRAM
WHISPER_USE_FP16=true  # Float16 para economia de VRAM
WHISPER_BEAM_SIZE=5  # Beam search: 5=PADRÃO (balanceado), 1=greedy (rápido)

# ===== DIRETÓRIOS =====
UPLOAD_DIR=./uploads
PROCESSED_DIR=./processed
TEMP_DIR=./temp
VOICE_PROFILES_DIR=./voice_profiles
MODELS_DIR=./models
LOG_DIR=./logs

# ===== LOGGING =====
LOG_LEVEL=DEBUG  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json ou text
LOG_ROTATION=1 day
LOG_RETENTION=30 days

# ===== FFMPEG =====
FFMPEG_THREADS=0  # 0 = auto
FFMPEG_AUDIO_CODEC=pcm_s16le  # Codec ideal para processamento
