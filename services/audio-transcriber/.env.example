# ===== CONFIGURAÇÃO DO SERVIÇO DE TRANSCRIÇÃO DE ÁUDIO =====
# Copie este arquivo para .env e ajuste os valores conforme necessário

# ===== APLICAÇÃO =====
APP_NAME=Audio Transcription Service
VERSION=2.0.0
ENVIRONMENT=development  # development, staging, production
DEBUG=false

# ===== SERVIDOR =====
HOST=0.0.0.0
PORT=8002
WORKERS=1  # Número de workers Uvicorn

# ===== REDIS =====
# Para Docker Compose: redis://redis:6379/0
# Para desenvolvimento local: redis://localhost:6379/0
# Para Redis remoto: redis://usuario:senha@host:porta/db
REDIS_URL=redis://localhost:6379/0
REDIS_MIN_MEMORY_BYTES=52428800  # Mínimo de 50MB para inicialização

# ===== CELERY =====
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0
CELERY_TASK_TIME_LIMIT=3600  # 1 hora máximo por task
CELERY_TASK_SOFT_TIME_LIMIT=3300  # 55 minutos soft limit

# ===== CACHE =====
CACHE_TTL_HOURS=24  # 1-168 (7 dias máximo)
CACHE_CLEANUP_INTERVAL_MINUTES=30  # 5-1440
CACHE_MAX_SIZE_MB=2048

# ===== LIMITES DE ARQUIVO =====
MAX_FILE_SIZE_MB=500  # Tamanho máximo do arquivo (1-2000MB)
MAX_DURATION_MINUTES=120  # Duração máxima do áudio (1-240 minutos)

# ===== WHISPER - MODELO =====
# Modelos disponíveis: tiny, base, small, medium, large, large-v2, large-v3
# tiny: ~39M, ~1GB VRAM, ~32x mais rápido
# base: ~74M, ~1GB VRAM, ~16x mais rápido (RECOMENDADO PARA PRODUÇÃO)
# small: ~244M, ~2GB VRAM, ~6x mais rápido
# medium: ~769M, ~5GB VRAM, ~2x mais rápido
# large: ~1550M, ~10GB VRAM, melhor qualidade
WHISPER_MODEL=base
WHISPER_DEVICE=cpu  # cpu ou cuda (se tiver GPU NVIDIA)
WHISPER_DOWNLOAD_ROOT=./models
WHISPER_DEFAULT_LANGUAGE=auto  # auto para detecção automática

# ===== WHISPER - CHUNKS (ACELERAÇÃO) =====
# IMPORTANTE: Processar áudio em chunks ACELERA significativamente a transcrição
# Para áudios longos (>5min), o chunking é ESSENCIAL
WHISPER_ENABLE_CHUNKING=true  # Habilitar processamento em chunks
WHISPER_CHUNK_LENGTH_SECONDS=30  # Duração de cada chunk (10-120s)
WHISPER_CHUNK_OVERLAP_SECONDS=1.0  # Overlap entre chunks para contexto (0.5-5.0s)

# ===== WHISPER - OTIMIZAÇÕES =====
WHISPER_FP16=false  # true se tiver GPU NVIDIA
WHISPER_BEAM_SIZE=5  # 1-10 (5 = padrão)
WHISPER_BEST_OF=5  # 1-10 (5 = padrão)
WHISPER_TEMPERATURE=0.0  # 0.0-1.0 (0.0 = mais preciso)

# ===== DIRETÓRIOS =====
UPLOAD_DIR=./uploads
TRANSCRIPTION_DIR=./transcriptions
MODELS_DIR=./models
TEMP_DIR=./temp
LOG_DIR=./logs

# ===== LOGGING =====
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json ou text

# ===== SEGURANÇA =====
SECURITY__RATE_LIMIT_REQUESTS=50  # Requests por minuto
SECURITY__RATE_LIMIT_WINDOW=60  # Janela em segundos
SECURITY__ENABLE_FILE_CONTENT_VALIDATION=true
SECURITY__VALIDATE_AUDIO_HEADERS=true
SECURITY__MAX_UPLOAD_ATTEMPTS=3
SECRET_KEY=your_secret_key_here

# ===== TIMEOUTS =====
ASYNC_TIMEOUT_SECONDS=1800  # 30 minutos
JOB_PROCESSING_TIMEOUT_SECONDS=3600  # 1 hora
POLL_INTERVAL_SECONDS=2

# ===== FFMPEG =====
FFMPEG_THREADS=0  # 0 = auto
FFMPEG_AUDIO_CODEC=pcm_s16le  # Codec ideal para Whisper
FFMPEG_SAMPLE_RATE=16000  # 16kHz ideal para Whisper
