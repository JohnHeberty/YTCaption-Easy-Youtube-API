[pytest]
# ============================================================================
# Configuração do Pytest para Audio Transcriber Service
# ============================================================================

# Diretórios de teste
testpaths = tests

# Padrão de arquivos de teste
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Markers customizados
markers =
    unit: testes unitários (rápidos, isolados)
    integration: testes de integração (múltiplos componentes)
    e2e: testes end-to-end (sistema completo)
    real: usa APIs/serviços reais externos
    slow: testes que demoram > 5s
    gpu: requer GPU disponível
    celery: requer Celery workers rodando
    asyncio: testes assíncronos

# Opções de output
addopts =
    -v
    --strict-markers
    --tb=short
    --disable-warnings
    --color=yes
    --maxfail=5
    # Ignora testes reais por padrão
    -m "not real"

# Timeout padrão para testes (previne testes travados)
timeout = 30

# Logging
log_cli = false
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

log_file = tests/logs/pytest.log
log_file_level = DEBUG
log_file_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_file_date_format = %Y-%m-%d %H:%M:%S

# Asyncio
asyncio_mode = auto

# Cobertura (coverage)
# Descomente para habilitar cobertura automática
# addopts = --cov=app --cov-report=term-missing --cov-report=html

# Diretórios/arquivos a ignorar
norecursedirs = 
    .git
    .venv
    venv
    __pycache__
    *.egg-info
    build
    dist
    node_modules

# Filtra warnings específicos
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    # Adicione warnings específicos para ignorar aqui

# ============================================================================
# Exemplos de uso:
# ============================================================================
#
# Todos os testes (exceto reais):
#   pytest
#
# Apenas unit tests:
#   pytest -m unit
#
# Apenas integration tests:
#   pytest -m integration
#
# Incluindo testes reais:
#   pytest -m real
#
# Testes rápidos (não slow):
#   pytest -m "not slow"
#
# Com cobertura:
#   pytest --cov=app --cov-report=html
#
# Paralelo (mais rápido):
#   pytest -n auto
#
# Específico:
#   pytest tests/unit/test_config.py::test_specific_function
#
# ============================================================================
